var j=Object.defineProperty;var i=(t,a)=>j(t,"name",{value:a,configurable:!0});import{useEffect as d}from"react";import{useTable as K}from"@refinedev/core";import{useReactTable as N,getCoreRowModel as V,getSortedRowModel as W,getFilteredRowModel as X}from"@tanstack/react-table";import{useEffect as G,useRef as J}from"react";var v=i(()=>{let t=J(!0);return G(()=>{t.current=!1},[]),t.current},"useIsFirstRender");function Y({refineCoreProps:{hasPagination:t=!0,...a}={},initialState:P={},...B}){var x,y,C;let m=v(),R=K({...a,hasPagination:t}),g=(((x=a.filters)==null?void 0:x.mode)||"server")==="server",b=(((y=a.sorters)==null?void 0:y.mode)||"server")==="server",O=t===!1?"off":"server",E=(((C=a.pagination)==null?void 0:C.mode)??O)!=="off",{tableQueryResult:{data:l},current:Q,setCurrent:u,pageSize:H,setPageSize:h,sorters:w,setSorters:z,filters:M,setFilters:U,pageCount:I}=R,p=[];M.forEach(e=>{e.operator!=="or"&&e.operator!=="and"&&"field"in e&&p.push(e)});let F=N({data:(l==null?void 0:l.data)??[],getCoreRowModel:V(),getSortedRowModel:b?void 0:W(),getFilteredRowModel:g?void 0:X(),initialState:{pagination:{pageIndex:Q-1,pageSize:H},sorting:w.map(e=>({id:e.field,desc:e.order==="desc"})),columnFilters:p.map(e=>({id:e.field,operator:e.operator,value:e.value})),...P},pageCount:I,manualPagination:!0,manualSorting:b,manualFiltering:g,...B}),{state:L,columns:k}=F.options,{pagination:q,sorting:o,columnFilters:s}=L,{pageIndex:T,pageSize:c}=q??{};return d(()=>{T!==void 0&&u(T+1)},[T]),d(()=>{c!==void 0&&h(c)},[c]),d(()=>{o!==void 0&&(z(o==null?void 0:o.map(e=>({field:e.id,order:e.desc?"desc":"asc"}))),o.length>0&&E&&!m&&u(1))},[o]),d(()=>{let e=[];s==null||s.map(r=>{var D,S;let n=r.operator??((S=(D=k.find(A=>A.id===r.id))==null?void 0:D.meta)==null?void 0:S.filterOperator);e.push({field:r.id,operator:n??(Array.isArray(r.value)?"in":"eq"),value:r.value})});let f=p.filter(r=>!e.some(n=>r.field===n.field&&r.operator===n.operator));f==null||f.map(r=>{e.push({field:r.field,operator:r.operator,value:void 0})}),U(e),e.length>0&&E&&!m&&u(1)},[s]),{...F,refineCore:R}}i(Y,"useTable");export{Y as useTable};
//# sourceMappingURL=index.js.map