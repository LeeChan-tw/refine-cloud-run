var T=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var W=Object.getOwnPropertyNames;var X=Object.prototype.hasOwnProperty;var c=(t,r)=>T(t,"name",{value:r,configurable:!0});var Y=(t,r)=>{for(var n in r)T(t,n,{get:r[n],enumerable:!0})},Z=(t,r,n,l)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of W(r))!X.call(t,o)&&o!==n&&T(t,o,{get:()=>r[o],enumerable:!(l=V(r,o))||l.enumerable});return t};var _=t=>Z(T({},"__esModule",{value:!0}),t);var $={};Y($,{useTable:()=>w});module.exports=_($);var d=require("react"),h=require("@refinedev/core"),s=require("@tanstack/react-table");var f=require("react");var H=c(()=>{let t=(0,f.useRef)(!0);return(0,f.useEffect)(()=>{t.current=!1},[]),t.current},"useIsFirstRender");function w({refineCoreProps:{hasPagination:t=!0,...r}={},initialState:n={},...l}){var v,P,B;let o=H(),x=(0,h.useTable)({...r,hasPagination:t}),y=(((v=r.filters)==null?void 0:v.mode)||"server")==="server",C=(((P=r.sorters)==null?void 0:P.mode)||"server")==="server",z=t===!1?"off":"server",D=(((B=r.pagination)==null?void 0:B.mode)??z)!=="off",{tableQueryResult:{data:m},current:M,setCurrent:R,pageSize:U,setPageSize:I,sorters:L,setSorters:k,filters:q,setFilters:A,pageCount:j}=x,g=[];q.forEach(e=>{e.operator!=="or"&&e.operator!=="and"&&"field"in e&&g.push(e)});let S=(0,s.useReactTable)({data:(m==null?void 0:m.data)??[],getCoreRowModel:(0,s.getCoreRowModel)(),getSortedRowModel:C?void 0:(0,s.getSortedRowModel)(),getFilteredRowModel:y?void 0:(0,s.getFilteredRowModel)(),initialState:{pagination:{pageIndex:M-1,pageSize:U},sorting:L.map(e=>({id:e.field,desc:e.order==="desc"})),columnFilters:g.map(e=>({id:e.field,operator:e.operator,value:e.value})),...n},pageCount:j,manualPagination:!0,manualSorting:C,manualFiltering:y,...l}),{state:G,columns:J}=S.options,{pagination:K,sorting:i,columnFilters:u}=G,{pageIndex:b,pageSize:E}=K??{};return(0,d.useEffect)(()=>{b!==void 0&&R(b+1)},[b]),(0,d.useEffect)(()=>{E!==void 0&&I(E)},[E]),(0,d.useEffect)(()=>{i!==void 0&&(k(i==null?void 0:i.map(e=>({field:e.id,order:e.desc?"desc":"asc"}))),i.length>0&&D&&!o&&R(1))},[i]),(0,d.useEffect)(()=>{let e=[];u==null||u.map(a=>{var O,Q;let p=a.operator??((Q=(O=J.find(N=>N.id===a.id))==null?void 0:O.meta)==null?void 0:Q.filterOperator);e.push({field:a.id,operator:p??(Array.isArray(a.value)?"in":"eq"),value:a.value})});let F=g.filter(a=>!e.some(p=>a.field===p.field&&a.operator===p.operator));F==null||F.map(a=>{e.push({field:a.field,operator:a.operator,value:void 0})}),A(e),e.length>0&&D&&!o&&R(1)},[u]),{...S,refineCore:x}}c(w,"useTable");
//# sourceMappingURL=index.js.map